{% extends "base.html" %}

{% block titulo_conteudo %}Notas Fiscais Lançadas{% endblock %}

{% block conteudo %}
<div class="mb-3 text-end">
    <a href="{% url 'notafiscal_nova' %}" class="btn btn-success">
        <i class="fas fa-plus"></i> Lançar Nova NF
    </a>
</div>

<div class="table-responsive">
    <table class="table table-hover table-striped">
        <thead class="table-dark">
            <tr>
                <th>Nº NF</th>
                <th>Emissão</th>
                <th>Fornecedor (OC)</th>
                <th>Valor (R$)</th>
                <th>Fluig ID</th>
                <th>Arquivo</th>
                <th>Responsável</th>
            </tr>
        </thead>
        <tbody>
            {% for nf in notas %}
            <tr>
                <td class="fw-bold">{{ nf.numero_nf }}</td>
                <td>{{ nf.data_emissao|date:"d/m/Y" }}</td>
                <td>
                    <span title="OC #{{ nf.ordem_compra.id }}">{{ nf.ordem_compra.fornecedor }}</span>
                </td>
                <td>R$ {{ nf.ordem_compra.valor_estimado }}</td>
                <td>{{ nf.numero_fluig }}</td>
                <td>
                    {% if nf.arquivo_nf %}
                        <a href="{{ nf.arquivo_nf.url }}" target="_blank" class="btn btn-sm btn-outline-danger">
                            <i class="fas fa-file-pdf"></i> PDF
                        </a>
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td class="small text-muted">
                    {{ nf.responsavel_lancamento.username|default:"Sistema" }} <br>
                    em {{ nf.data_lancamento|date:"d/m H:i" }}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="7" class="text-center py-4 text-muted">
                    <i class="fas fa-inbox fa-2x mb-2"></i><br>
                    Nenhuma nota fiscal lançada até o momento.
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}